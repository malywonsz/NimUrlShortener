# base image
FROM nimlang/nim:1.0.4-regular

# set working directory
WORKDIR /usr/src/app

# copy app
COPY . .

# entrypoint.sh
RUN chmod +x /usr/src/app/entrypoint.sh

# add user
RUN addgroup --system user && adduser --system --no-create-home --group user
RUN chown -R user:user /usr/src/app && chmod -R 755 /usr/src/app
USER user

# Nim environment
ARG NIM_ENV=production
ENV NIM_ENV $NIM_ENV

# RUN script
CMD ["./entrypoint.sh"]
